# מערכת הפרקים והרפרנסים המקושרים

## הגדרה ראשונית

### שלב 1: הרצת סקריפט SQL למבנה מסד הנתונים

1. פתח את Supabase Dashboard
2. עבור ל-SQL Editor
3. הרץ את הסקריפטים הבאים בסדר הזה:

#### א. סקריפט בסיסי (אם עדיין לא הרצת):
```sql
-- הרץ את setup-supabase.sql
```

#### ב. סקריפט מערכת המוניטין (אם עדיין לא הרצת):
```sql
-- הרץ את setup-reputation-system.sql
```

#### ג. סקריפט מערכת הפרקים (חדש):
```sql
-- הרץ את setup-chapters-system.sql
```

### שלב 2: הוספת פרקים ראשונים

לאחר הרצת הסקריפטים, תוכל להוסיף פרקים דרך Supabase Dashboard או דרך SQL:

```sql
INSERT INTO chapters (title, description, video_url, order_index)
VALUES 
  ('פרק 1', 'תיאור הפרק הראשון', 'https://www.youtube.com/watch?v=VIDEO_ID', 0),
  ('פרק 2', 'תיאור הפרק השני', 'https://www.youtube.com/watch?v=VIDEO_ID', 1);
```

## מבנה מסד הנתונים

### טבלת chapters
- `id` - UUID (מפתח ראשי)
- `title` - כותרת הפרק
- `description` - תיאור הפרק
- `video_url` - קישור לוידאו (YouTube או אחר)
- `order_index` - סדר הפרק (0, 1, 2...)
- `created_at` - תאריך יצירה
- `updated_at` - תאריך עדכון אחרון

### טבלת references (מעודכנת)
- כל השדות הקיימים
- `chapter_id` - קישור לפרק (חדש)

### טבלת reference_links (חדשה)
- `id` - UUID (מפתח ראשי)
- `source_reference_id` - רפרנס מקור
- `target_reference_id` - רפרנס יעד
- `created_at` - תאריך יצירה

## שימוש במערכת

### דף הבית
- מציג את כל הפרקים
- לחיצה על פרק מעבירה לדף הפרק

### דף פרק
- נגן וידאו של הפרק
- רשימת רפרנסים של הפרק
- הוספת רפרנסים חדשים
- קישור רפרנסים לרפרנסים אחרים

### רפרנסים מקושרים
- כל רפרנס יכול להיות מקושר לרפרנסים אחרים מאותו פרק או מפרקים אחרים
- לחיצה על רפרנס מקושר פותחת חלון חדש עם הפרק המתאים באותה נקודת זמן

## תכונות נוספות

- מערכת אימות משתמשים (Magic Link)
- מערכת נקודות ואימות רפרנסים
- ממשק בעברית RTL מלא
- תמיכה בפתיחת רפרנסים בחלון חדש עם פרמטרי URL

